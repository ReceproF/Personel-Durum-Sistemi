<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Personel Durum Sistemi</title>
  <!-- Firebase CDN -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { color: #2b2b2b; }
    .personel { 
      border: 1px solid #ccc; 
      padding: 10px; 
      margin: 10px; 
      border-radius: 8px; 
      background: #f9f9f9;
    }
    button { 
      margin: 5px; 
      padding: 6px 12px; 
      border-radius: 5px; 
      border: none; 
      cursor: pointer; 
    }
    button:first-child { background: #ff9800; color: white; }
    button:last-child { background: #4caf50; color: white; }
  </style>
</head>
<body>
  <h2>ðŸ“‹ Personel Durum Sistemi</h2>
  <div id="personel-list"></div>

  <script>
    // ðŸ”¹ Firebase ayarlarÄ±n (senin verdiÄŸin deÄŸerlerle)
    const firebaseConfig = {
      apiKey: "AIzaSyBArO2jO3W0wZt-lsPMTPk4KN8Kd9NHUhU",
      authDomain: "personeldurumistemi.firebaseapp.com",
      databaseURL: "https://personeldurumistemi-default-rtdb.firebaseio.com",
      projectId: "personeldurumistemi",
      storageBucket: "personeldurumistemi.firebasestorage.app",
      messagingSenderId: "356887995499",
      appId: "1:356887995499:web:d4d8de49de6cac5a447d2e"
    };

    // ðŸ”¹ Firebase baÅŸlat
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const personelListDiv = document.getElementById("personel-list");

    // ðŸ”¹ Personelleri getir ve canlÄ± olarak listele
    function loadPersonel() {
      db.ref("personeller").on("value", (snapshot) => {
        const data = snapshot.val();
        personelListDiv.innerHTML = "";
        for (let id in data) {
          const p = data[id];
          const div = document.createElement("div");
          div.className = "personel";
          div.innerHTML = `
            <b>${p.ad}</b><br>
            Durum: ${p.durum || "Ã‡alÄ±ÅŸÄ±yor"}<br>
            Neden: ${p.neden || "-"}<br>
            DÃ¶nÃ¼ÅŸ: ${p.donus || "-"}<br>
            <button onclick="izinVer('${id}')">Ä°zin Ver</button>
            <button onclick="calisiyor('${id}')">Ã‡alÄ±ÅŸÄ±yor</button>
          `;
          personelListDiv.appendChild(div);
        }
      });
    }

    // ðŸ”¹ Durumu "Ä°zinli" yap
    function izinVer(id) {
      const neden = prompt("Ä°zin nedeni?");
      const donus = prompt("DÃ¶nÃ¼ÅŸ tarihi/saati?");
      db.ref("personeller/" + id).update({
        durum: "Ä°zinli",
        neden: neden || "-",
        donus: donus || "-",
        guncelleme: new Date().toISOString()
      });
    }

    // ðŸ”¹ Durumu "Ã‡alÄ±ÅŸÄ±yor" yap
    function calisiyor(id) {
      db.ref("personeller/" + id).update({
        durum: "Ã‡alÄ±ÅŸÄ±yor",
        neden: null,
        donus: null,
        guncelleme: new Date().toISOString()
      });
    }

    // ðŸ”¹ Ä°lk test verisi (sadece 1 defa Ã§alÄ±ÅŸtÄ±r, sonra yoruma al!)
    /*
    db.ref("personeller").set({
      1: { ad: "Ahmet", durum: "Ã‡alÄ±ÅŸÄ±yor" },
      2: { ad: "AyÅŸe", durum: "Ã‡alÄ±ÅŸÄ±yor" },
      3: { ad: "Mehmet", durum: "Ã‡alÄ±ÅŸÄ±yor" }
    });
    */

    loadPersonel();
  </script>
</body>
</html>
